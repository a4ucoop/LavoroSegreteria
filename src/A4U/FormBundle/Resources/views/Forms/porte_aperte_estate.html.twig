{% extends '::base.html.twig' %}

{% block title %}Porte Aperte Estate{% endblock %}

{% block stylesheets %}

	{{ parent() }}
	<link href="{{ asset('bundles/a4uform/css/form.css') }}" type="text/css" rel="stylesheet">
	{{ form_stylesheet(form) }}

{% endblock %}

{% block body %}
    {% include 'A4UFormBundle::Forms/base_form.html.twig'  %}
{% endblock %}

{% block javascripts %}
	
	{{ parent() }}
	{{ form_javascript(form) }}

	<script type="text/javascript" src="{{ asset('bundles/a4uform/javascript/form_porteAperteEstate.js') }}"></script>
	<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=places"></script>

	<script type="text/javascript">
		var city=document.getElementById('porteAperteEstate_city');
		var address=document.getElementById('porteAperteEstate_address');
		var birthPlace=document.getElementById('porteAperteEstate_birthPlace');
		var CAP=document.getElementById('porteAperteEstate_cap');

		var autocompleteCity = new google.maps.places.Autocomplete(city);
		var autocompleteAddress = new google.maps.places.Autocomplete(address);
		var autocompleteBirthPlace = new google.maps.places.Autocomplete(birthPlace);
		var autocompleteCAP = new google.maps.places.Autocomplete(CAP);
    var $schoolRegion = $('#stage_attendedSchoolRegion');
    $(document).on('change', '#stage_attendedSchoolRegion', function() {
      var $form = $(this).closest('form');
      var data = {};
      data[$schoolRegion.attr('name')] = $schoolRegion.val();

      $.ajax({
        url : $form.attr('action'),
        type: $form.attr('method'),
        data : data,
        success: function(html) {
          $('#stage_attendedSchoolDistrict').replaceWith(
            $(html).find('#stage_attendedSchoolDistrict')
          );
          $('#stage_attendedSchoolCity').replaceWith(
            $(html).find('#stage_attendedSchoolCity')
          );
          $('#stage_attendedSchool').replaceWith(
            $(html).find('#stage_attendedSchool')
          );
        }
      });
    });


    var $schoolDistrict = $('#stage_attendedSchoolDistrict');
    $(document).on('change', '#stage_attendedSchoolDistrict', function() {
      var $form = $(this).closest('form');
      var data = {};
      data[$schoolDistrict.attr('name')] = $('#stage_attendedSchoolDistrict').val();
      data[$schoolRegion.attr('name')] = $schoolRegion.val();
      $.ajax({
        url : $form.attr('action'),
        type: $form.attr('method'),
        data : data,
        success: function(html) {
          $('#stage_attendedSchoolCity').replaceWith(
            $(html).find('#stage_attendedSchoolCity')
          );
          $('#stage_attendedSchool').replaceWith(
            $(html).find('#stage_attendedSchool')
          );
        }
      });
    });


    var $schoolCity = $('#stage_attendedSchoolCity');
    $(document).on('change', '#stage_attendedSchoolCity', function() {
      var $form = $(this).closest('form');
      var data = {};
      data[$schoolRegion.attr('name')] = $schoolRegion.val();
      data[$schoolDistrict.attr('name')] = $('#stage_attendedSchoolDistrict').val();
      data[$schoolCity.attr('name')] = $('#stage_attendedSchoolCity').val();
      $.ajax({
        url : $form.attr('action'),
        type: $form.attr('method'),
        data : data,
        success: function(html) {
          $('#stage_attendedSchool').replaceWith(
            $(html).find('#stage_attendedSchool')
          );
        }
      });
    });

    var $school = $('#stage_attendedSchool');
    $(document).on('change', '#stage_attendedSchool', function() {
      var $form = $(this).closest('form');
      var data = {};
      data[$school.attr('name')] = $('#stage_attendedSchool').val();
    });
	</script>

{% endblock %}
